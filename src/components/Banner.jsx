import { useState, useEffect } from "react";
import { Container, Row, Col } from "react-bootstrap";
import image from "../assets/img/index";
import { ArrowRightCircle } from "react-bootstrap-icons";
import "animate.css";
import TrackVisibility from "react-on-screen";

export const Banner = () => {
  const [loopNum, setLoopNum] = useState(0);
  const [isDeleting, setIsDeleting] = useState(false);
  const [text, setText] = useState("");
  const [delta, setDelta] = useState(300 - Math.random() * 100);
  const [index, setIndex] = useState(1);
  const toRotate = [
    "Blockchain Developer",
    "Front-End Engineer",
    "Web3 Developer",
    "Full-Stack Developer?",
  ];
  const period = 2000;

  useEffect(() => {
    let ticker = setInterval(() => {
      tick();
    }, delta);

    return () => {
      clearInterval(ticker);
    };
  }, [text]);

  const tick = () => {
    let i = loopNum % toRotate.length;
    let fullText = toRotate[i];
    let updatedText = isDeleting
      ? fullText.substring(0, text.length - 1)
      : fullText.substring(0, text.length + 1);

    setText(updatedText);

    if (isDeleting) {
      setDelta((prevDelta) => prevDelta / 2);
    }

    if (!isDeleting && updatedText === fullText) {
      setIsDeleting(true);
      setIndex((prevIndex) => prevIndex - 1);
      setDelta(period);
    } else if (isDeleting && updatedText === "") {
      setIsDeleting(false);
      setLoopNum(loopNum + 1);
      setIndex(1);
      setDelta(500);
    } else {
      setIndex((prevIndex) => prevIndex + 1);
    }
  };

  return (
    <section className="banner" id="home">
      <Container>
        <Row className="aligh-items-center">
          <Col xs={12} md={6} xl={7}>
            <TrackVisibility>
              {({ isVisible }) => (
                <div
                  className={
                    isVisible ? "animate__animated animate__fadeIn" : ""
                  }
                >
                  <span className="tagline">Welcome to my portfolio</span>
                  <h1>
                    {`Hi! I'm Douglas`}{" "}
                    <span
                      className="txt-rotate"
                      dataPeriod="1000"
                      data-rotate='[ "Web Developer", "Web Designer", "UI/UX Designer" ]'
                    >
                      <span className="wrap">{text}</span>
                    </span>
                  </h1>
                  <p>
                    I'm a passionate full-stack blockchain developer dedicated
                    to crafting modern and user-friendly websites and
                    applications with expertise in blockchain technology. With a
                    strong background in HTML, CSS, JavaScript, and responsive
                    design, I bring a unique set of skills to every project I
                    work on. Whether you need a website or web application
                    integrated with blockchain functionalities, decentralized
                    finance (DeFi) solutions, smart contracts, or tokenization,
                    I have the experience and knowledge to bring your
                    blockchain-powered vision to life. My goal is to help my
                    clients leverage blockchain technology to achieve their
                    business objectives through effective website design and
                    development. Let's collaborate to create something amazing
                    that combines cutting-edge technology with user-centric
                    design!
                  </p>

                  <button
                    onClick={() => {
                      let target = document.querySelector("#connect");
                      target.scrollIntoView({ behavior: "smooth" });
                    }}
                  >
                    Letâ€™s Connect <ArrowRightCircle size={25} />{" "}
                  </button>
                </div>
              )}
            </TrackVisibility>
          </Col>
          <Col xs={12} md={6} xl={5}>
            <TrackVisibility>
              {({ isVisible }) => (
                <div
                  className={
                    isVisible ? "animate__animated animate__zoomIn" : ""
                  }
                >
                  <img src={image.headerImg} alt="Header Img" />
                </div>
              )}
            </TrackVisibility>
          </Col>
        </Row>
      </Container>
    </section>
  );
};
